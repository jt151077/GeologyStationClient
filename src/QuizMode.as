package  {		import flash.display.*;	import flash.events.*;	import flash.media.Sound;	import flash.media.SoundChannel;	import flash.net.*;	import flash.utils.Timer;		import gs.TweenLite;	import gs.easing.*;		public class QuizMode extends MovieClip {				public static const COMPLETE:String = "complete";				private var qTF:TField = new TField(Fonts.qText(), 1920);		private var maskCircle:MovieClip = new MovieClip();		private var bgshape:Sprite;		private var default_bg_color:uint = 0xff4400;		private var qText:String;				private var image:MovieClip = new MovieClip();		private var flowerMask:FlowerMask = new FlowerMask();		private var corretAnswer:Boolean = false;				private var loader:Loader;		private var quizIntro:MovieClip = new MovieClip();		private var channel:SoundChannel = new SoundChannel();				private var _questionNumber:String;				private var qSound:Sound;				public function QuizMode(qImage:Bitmap, qT:String, snd:Sound, questionNumber:String) {								trace("quest: "+questionNumber);			this._questionNumber = questionNumber;			qSound = snd;						qText = qT;			qTF.content = qT;			image.addChild(qImage);						loader = new Loader();			loader.contentLoaderInfo.addEventListener(Event.COMPLETE, playIntro);			loader.load(new URLRequest('assets/fla/QuizIntro.swf'));					}				public function stopSound():void {			if(this.qSound != null) {				channel.stop();			}		}		private function playIntro(e:Event):void {			trace('hello');			quizIntro = e.target.content;			//quizIntro.addChild(e.target.content);			addChild(quizIntro);									quizIntro.play();			quizIntro.flag.numberTF.text = "#"+this._questionNumber;			//quizIntro.testing.text = "#1";			quizIntro.addEventListener('complete', playQuestion);		}				private function playQuestion(e:Event):void {						removeChild(quizIntro);				addChild(image);						image.x = 0;			image.y = 0;				maskCircle.graphics.lineStyle(0);			maskCircle.graphics.beginFill(0xffffff)			maskCircle.graphics.drawCircle(2, 2, 10);			maskCircle.x = 1920/2;			maskCircle.y = 1080/2;			maskCircle.graphics.endFill();						addChild(flowerMask);						flowerMask.width = 10;			flowerMask.height = 10;			flowerMask.x = 1920/2;			flowerMask.y = 1080/2;			image.mask = flowerMask;					qTF.x = 0;			qTF.y = 50;			addChild(qTF);										  			TweenLite.to(flowerMask, 7, {scaleX: 400, scaleY: 400});			//TweenLite.to(image, 10, {y:200})						initBG();						addChildAt(bgshape, 0);			bgshape.alpha = 0;						channel = qSound.play();		}		public function reset():void {			qTF.content = "";			TweenLite.to(flowerMask, 0.2, {scaleX: 0.1, scaleY: 0.1, onComplete: poseQ});		}		public function exit():void {			qTF.content = "";			TweenLite.to(flowerMask, 0.5, {scaleX: 35, scaleY: 35, onComplete: remove});			dispatchEvent(new Event(COMPLETE));		}		private function remove():void {			TweenLite.to(flowerMask, 0.5, {delay: 1, scaleX: 0.1, scaleY: 0.1});// onComplete: dispatchEvent, onCompleteParams: [new Event(COMPLETE)]}		}		private function poseQ():void {						qTF.content = qText;			qTF.x = 0;			qTF.y = 50;						flowerMask.width = 10;			flowerMask.height = 10;			flowerMask.x = 1920/2;			flowerMask.y = 1080/2;									maskCircle.graphics.drawCircle(2, 2, 10);			maskCircle.x = stage.stageWidth/2;			maskCircle.y = stage.stageHeight/2;						image.alpha = 1;				bgshape.alpha = 0;			image.mask = flowerMask;					TweenLite.to(flowerMask, 5, {scaleX: 400, scaleY: 400});		}						private function updateText(t:String, c:uint):void {			bgshape.alpha = 1;			changeBGColor(c);			bgshape.mask = flowerMask;			image.alpha = 0;			//qTF.mask = maskCircle;			flowerMask.x = stage.stageWidth/2;			flowerMask.y = qTF.y = stage.stageHeight/2;						maskCircle.x = stage.stageWidth/2;			maskCircle.y = qTF.y = stage.stageHeight/2;			qTF.x = 0;			TweenLite.to(flowerMask, 1, {scaleX: 16, scaleY: 16, ease:Elastic.easeOut, easeParams: [2,3]});			qTF.content = t;					}				public function correctAnswer():void {			corretAnswer = true;			qTF.content = "";			TweenLite.to(flowerMask, 0.2, {scaleX: 0.1, scaleY: 0.1, onComplete:updateText, onCompleteParams:['Det er riktig.\nKjempebra!', 0x6BB95C]})														}				public function wrongAnswer():void {			qTF.content = "";			TweenLite.to(flowerMask, 0.2, {scaleX: 0.1, scaleY: 0.1, onComplete:updateText, onCompleteParams:['Det er ikke riktig.\nPrøv igjen!', 0xFF581E]})							}				private function initBG()		{		    bgshape = new Sprite();		    bgshape.graphics.beginFill(default_bg_color);		    bgshape.graphics.drawRect(0,0,1920, 1080);		    addChildAt(bgshape, 0);		    //stage.addEventListener(Event.RESIZE, resizeBGWithStage);		}				private function changeBGColor(color:uint) 		{		    bgshape.graphics.beginFill(color);		    bgshape.graphics.drawRect(0,0, 1920, 1080);		}				private function resizeBGWithStage(e:Event)		{		    try {		        bgshape.width = 1920;		        bgshape.height = 1080;		    } catch(e){}		}			}	}